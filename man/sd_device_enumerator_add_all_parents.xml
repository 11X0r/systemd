<?xml version="1.0"?>
<!DOCTYPE refentries PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
  "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd">
<!-- SPDX-License-Identifier: LGPL-2.1-or-later -->

<refentry id="sd_device_enumerator_add_all_parents" xmlns:xi="http://www.w3.org/2001/XInclude">
  <refentryinfo>
    <title>sd_device_enumerator_add_all_parents</title>
    <productname>systemd</productname>
  </refentryinfo>

  <refmeta>
    <refentrytitle>sd_device_enumerator_add_all_parents</refentrytitle>
    <manvolnum>3</manvolnum>
  </refmeta>

  <refnamediv>
    <refname>sd_device_enumerator_add_all_parents</refname>
    <refname>sd_device_enumerator_add_match_parent</refname>
    <refname>sd_device_enumerator_add_match_property</refname>
    <refname>sd_device_enumerator_add_match_property_required</refname>
    <refname>sd_device_enumerator_add_match_subsystem</refname>
    <refname>sd_device_enumerator_add_match_sysattr</refname>
    <refname>sd_device_enumerator_add_match_sysname</refname>
    <refname>sd_device_enumerator_add_match_tag</refname>
    <refname>sd_device_enumerator_add_nomatch_sysname</refname>
    <refname>sd_device_enumerator_allow_uninitialized</refname>
    <refpurpose>Add a filter to the device enumerator</refpurpose>
  </refnamediv>

  <refsynopsisdiv>
    <funcsynopsis>
    <funcsynopsisinfo>#include &lt;systemd/sd-device.h&gt;</funcsynopsisinfo>

    <funcprototype>
      <funcdef>int <function>sd_device_enumerator_add_all_parents</function></funcdef>
      <paramdef>sd_device_enumerator *<parameter>enumerator</parameter></paramdef>
    </funcprototype>

    <funcprototype>
      <funcdef>int <function>sd_device_enumerator_add_match_parent</function></funcdef>
      <paramdef>sd_device_enumerator *<parameter>enumerator</parameter></paramdef>
      <paramdef>sd_device *<parameter>parent</parameter></paramdef>
    </funcprototype>

    <funcprototype>
      <funcdef>int <function>sd_device_enumerator_add_match_property</function></funcdef>
      <paramdef>sd_device_enumerator *<parameter>enumerator</parameter></paramdef>
      <paramdef>const char *<parameter>property</parameter></paramdef>
      <paramdef>const char *<parameter>value</parameter></paramdef>
    </funcprototype>

    <funcprototype>
      <funcdef>int <function>sd_device_enumerator_add_match_property_required</function></funcdef>
      <paramdef>sd_device_enumerator *<parameter>enumerator</parameter></paramdef>
      <paramdef>const char *<parameter>property</parameter></paramdef>
      <paramdef>const char *<parameter>value</parameter></paramdef>
    </funcprototype>

    <funcprototype>
      <funcdef>int <function>sd_device_enumerator_add_match_subsystem</function></funcdef>
      <paramdef>sd_device_enumerator *<parameter>enumerator</parameter></paramdef>
      <paramdef>const char *<parameter>subsystem</parameter></paramdef>
      <paramdef>int <parameter>match</parameter></paramdef>
    </funcprototype>

    <funcprototype>
      <funcdef>int <function>sd_device_enumerator_add_match_sysattr</function></funcdef>
      <paramdef>sd_device_enumerator *<parameter>enumerator</parameter></paramdef>
      <paramdef>const char *<parameter>sysattr</parameter></paramdef>
      <paramdef>const char *<parameter>value</parameter></paramdef>
      <paramdef>int <parameter>match</parameter></paramdef>
    </funcprototype>

    <funcprototype>
      <funcdef>int <function>sd_device_enumerator_add_match_sysname</function></funcdef>
      <paramdef>sd_device_enumerator *<parameter>enumerator</parameter></paramdef>
      <paramdef>const char *<parameter>sysname</parameter></paramdef>
    </funcprototype>

    <funcprototype>
      <funcdef>int <function>sd_device_enumerator_add_match_tag</function></funcdef>
      <paramdef>sd_device_enumerator *<parameter>enumerator</parameter></paramdef>
      <paramdef>const char *<parameter>tag</parameter></paramdef>
    </funcprototype>

    <funcprototype>
      <funcdef>int <function>sd_device_enumerator_add_nomatch_sysname</function></funcdef>
      <paramdef>sd_device_enumerator *<parameter>enumerator</parameter></paramdef>
      <paramdef>const char *<parameter>sysname</parameter></paramdef>
    </funcprototype>

    <funcprototype>
      <funcdef>int <function>sd_device_enumerator_allow_uninitialized</function></funcdef>
      <paramdef>sd_device_enumerator *<parameter>enumerator</parameter></paramdef>
    </funcprototype>

    </funcsynopsis>
  </refsynopsisdiv>

  <refsect1>
    <title>Description</title>

    <para>The <function>sd_device_enumerator_add_all_parents</function> function adds a filter to the
    enumerator so that all parent devices of the specified <parameter>enumerator</parameter> are
    enumerated. This is useful for cases where you want to include all parent devices in the
    enumeration, such as when you are interested in the entire device tree leading up to a specific
    device.</para>

    <para>The <function>sd_device_enumerator_add_match_parent</function> function adds a filter to the
    enumerator so that only devices whose parent matches the specified <parameter>parent</parameter>
    device are enumerated.</para>

    <para>The <function>sd_device_enumerator_add_match_property</function> function adds a filter to
    the enumerator so that only devices with the specified property <parameter>property</parameter>
    equal to <parameter>value</parameter> are enumerated.</para>

    <para>The <function>sd_device_enumerator_add_match_property_required</function> function adds a
    filter to the enumerator so that only devices with the specified property
    <parameter>property</parameter> equal to <parameter>value</parameter> are enumerated. This
    function is similar to <function>sd_device_enumerator_add_match_property</function>, but it
    requires that the property must exist on the device, not just match a value.</para>

    <para>The <function>sd_device_enumerator_add_match_subsystem</function> function adds a filter to
    the enumerator so that only devices in the specified <parameter>subsystem</parameter> are
    enumerated. The <parameter>match</parameter> parameter is a boolean flag
    (0 = exclude, 1 = include).</para>

    <para>The <function>sd_device_enumerator_add_match_sysattr</function> function adds a filter on
    the sysfs attribute <parameter>sysattr</parameter> matching <parameter>value</parameter>. The
    <parameter>match</parameter> parameter is boolean (0 = exclude, 1 = include).</para>

    <para>The <function>sd_device_enumerator_add_match_sysname</function> function adds a filter so
    that only devices whose sysname equals <parameter>sysname</parameter> are enumerated.</para>

    <para>The <function>sd_device_enumerator_add_match_tag</function> function adds a filter so that
    only devices tagged with <parameter>tag</parameter> are enumerated.</para>

    <para>The <function>sd_device_enumerator_add_nomatch_sysname</function> function adds a filter so
    that devices whose sysname equals <parameter>sysname</parameter> are excluded from the
    enumeration. This is useful for excluding specific devices from the enumeration process.</para>

    <para>The <function>sd_device_enumerator_allow_uninitialized</function> function allows devices
    that have not yet been initialized by udev to be included in the enumeration.</para>
  </refsect1>

  <refsect1>
    <title>Return Value</title>

    <para> All functions return 0 on success or a negative errno-style error code on failure.
    The error codes may include <code>ENODEV</code> if the specified device does not exist,
    <code>ENOMEM</code> if memory allocation fails, or other standard error codes.</para>

    <refsect2>
    <title>Errors</title>

    <para>Returned errors may indicate the following problems:</para>

    <variablelist>
      <varlistentry>
        <term><constant>-ENOMEM</constant></term>

        <listitem><para>Memory allocation failed.</para></listitem>
      </varlistentry>
      <varlistentry>
        <term><constant>-EINVAL</constant></term>

        <listitem><para>The argument is invalid.</para></listitem>
      </varlistentry>
    </variablelist>
  </refsect2>
  </refsect1>

  <refsect1>
  <title>Examples</title>

  <example>
    <title>Detect Removable USB Devices (Using Match and Exclude)</title>
    <programlisting><xi:include href="sd_device_enumerate_add_match_parent-example.c" parse="text"/></programlisting>
  </example>
  </refsect1>

  <refsect1>
    <title>History</title>

    <para>The functions <function>sd_device_enumerator_add_all_parents</function>,
    <function>sd_device_enumerator_add_match_parent</function>,
    <function>sd_device_enumerator_add_match_property</function>,
    <function>sd_device_enumerator_add_match_property_required</function>,
    <function>sd_device_enumerator_add_match_subsystem</function>,
    <function>sd_device_enumerator_add_match_sysattr</function>,
    <function>sd_device_enumerator_add_match_sysname</function>,
    <function>sd_device_enumerator_add_match_tag</function>,
    <function>sd_device_enumerator_add_nomatch_sysname</function>, and
    <function>sd_device_enumerator_allow_uninitialized</function> were added in version 240.</para>
  </refsect1>

  <refsect1>
    <title>See Also</title>

    <para><simplelist type="inline">
      <member><citerefentry><refentrytitle>sd_device_ref</refentrytitle><manvolnum>3</manvolnum></citerefentry></member>
      <member><citerefentry><refentrytitle>sd_device_enumerator_new</refentrytitle><manvolnum>3</manvolnum></citerefentry></member>
      <member><citerefentry><refentrytitle>sd_device_enumerator_get_device_first</refentrytitle><manvolnum>3</manvolnum></citerefentry></member>
    </simplelist></para>
  </refsect1>
</refentry>
